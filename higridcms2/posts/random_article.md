---
layout: post
title: 如何在静态博客中显示随机文章
description:  随机文章保证了网站的更新和收录，很多网站采用静态网页，没有连接数据库，但可利用 JQuery 技术在如何在静态博客中来产生随机文章功能，这样类似 jekyll 的静态博客也可以使用。
keywords: 随机文章,jquery随机文章
category :  网络技术
date :  2013-03-09
tags : [教程, jQuery]
---

 @hi@ 前段时间想增加一个 **随机文章**功能，用户每次进来看到的结果是不一样的，搜索引擎爬虫进来自然也是发现页面源代码和内容是不一样的，保证了网站的更新和收录，很多网站采用静态网页，没有连接数据库，不知能否做随机文章？本文主要利用 @jq@ 技术在**如何在静态博客中**来产生 **jquery随机文章**功能，这样类似 jekyll 的静态博客也可以使用，其他功能可参考 [无数据库实现站内静态网页搜索](/c-art-static_search_engine.htm) 及相关文章。

HIGRID_ART_ADS

## 设置随机文章的缺陷
设置 **随机文章** 存在一个缺陷，这个坏处主要是如果网站内容够丰富，更新量很大，比如大型行业网站，若在首页或者栏目页面采用随机文章，爬虫过来爬行文章也是有爬行时间和爬行内容数量限制的，所以对于网站来说增加收录是做排名做流量的前提，如果爬虫经常来反复的爬收录过的页面，势必影响到新文章收录。对爬虫来说经常看到被收录过的内容也是不太好，如果一个内容只有很小的改动，最好尽量避免爬虫的爬行，让它们有更多的时间去爬行新的内容。针对内容比较少的个人博客，随机文章的缺陷可以避免。

## 如何在静态博客中显示jQuery随机文章

如果是类似[WordPress](http://cn.wordpress.org "wordpress")这种博客平台，只需在数据库中随机选取一篇文章，然后返回给用户。当然对于静态博客，或采用 @jekyll@ 的博客由于全是静态页面，不太可能在和服务器产生交互。

其实有个简单的方法是使用 @jq@ 来实现，既然所有的文章都是静态页面，只需要从所有的文章中随机选取一篇，然后将当前的链接地址进行替换就行了，让浏览器重新发起请求，只不过不再是原来的页面，而是一个随机选择的页面。基于这样的想法，那我就需要能够读取到所有文章的信息，这用jQuery中的ajax是非常容易实现的，而且和后台完全无关，不需要后台的支持。获取所有的文章的信息之后，从中随机选取一篇，将其url地址返回出来，将当前页面的地址替换成返回出来的地址，也即让浏览器重新发起请求，这样就能够实现 **随机文章的访问** 了。

具体的流程是:

1. 利用 @jq@ 的`$.get`方法取得服务器上的atom.xml文件，这个文件是订阅文件，其中包含了整个博客中所有文章的信息。
2. 利用atom.xml中的信息，取得文章总数n
3. 随机生成一个介于0~n-1中的整数m
4. 从atom.xml中抽取出第m篇文章的url
5. 令`location.href=url`

具体代码如下:

<pre>

$(document).ready(function(){
$("#random").click(function(){
	$.get('/higrid_atom.xml',function(data){
	var $xml=$(data);
	entry=$xml.find("entry")
	n = entry.size()
	n = getRandom(n)
	url=entry.get(n)
	url=url.getElementsByTagName("link")[0]
	url=url.getAttribute("href")
	location.href=url

  })
	
})
	//随机数发生器
       function getRandom(n){return Math.floor(Math.random()*(n+1))}
});

</pre>


这样就达到了 **在静态博客中显示随机文章**的目的，当然这个只是简单的实现，有兴趣不妨一试。

